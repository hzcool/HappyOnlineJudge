(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[45],{"69df":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.loaded?s("div",{staticClass:"q-pa-lg"},[s("div",{staticClass:"text-h4 text-red q-mb-lg"},[t._v(" 帖子ID："+t._s(t.post_id)+" ")]),s("div",{staticClass:"text-black"},[s("div",{staticClass:"text-h6"},[t._v("文章类型: "),s("span",{staticClass:"text-primary"},[t._v(t._s(t.get_kind)+" ")])])]),s("q-separator",{staticClass:"q-mt-md"}),s("q-form",{staticClass:"text-black q-mt-md text-h6",on:{submit:t.submit}},["solution"!=t.kind?s("div",{staticClass:"q-gutter-md row items-start"},[s("div",[t._v("标 题")]),s("q-input",{staticStyle:{width:"500px"},attrs:{dense:"",outlined:"","lazy-rules":"",rules:[function(t){return t&&t.length>0||"请输入标题"},function(t){return t.length<=40||"标题太长"}]},model:{value:t.head,callback:function(e){t.head=e},expression:"head"}})],1):t._e(),"blog"!=t.kind?s("div",{staticClass:"row items-start q-gutter-md q-mt-md"},[s("div",[t._v("题 目")]),s("q-input",{staticStyle:{width:"200px"},attrs:{dense:"",outlined:"",disable:""},model:{value:t.problem,callback:function(e){t.problem=e},expression:"problem"}}),"puzzle"==t.kind?s("div",{staticClass:"text-blue"},[t._v("(可以不设置，如果设置了相关题目，该帖子会放到对应题目的讨论栏，不会出现公共系统的讨论栏中)")]):t._e()],1):t._e(),s("div",{staticClass:"q-gutter-sm row items-start q-mt-md"},[s("div",[t._v("公 开")]),s("q-toggle",{attrs:{color:"primary"},model:{value:t.is_open,callback:function(e){t.is_open=e},expression:"is_open"}}),s("div",{staticClass:"text-blue"},[t._v("(未编写完成时，推荐不公开)")])],1),s("div",{staticClass:"q-gutter-sm row items-start q-mt-md"},[s("div",[t._v("允许评论")]),s("q-toggle",{attrs:{color:"primary"},model:{value:t.can_reply,callback:function(e){t.can_reply=e},expression:"can_reply"}})],1),s("div",{staticClass:"q-mt-md"},[s("div",[t._v("系统标签")]),s("Tags",{ref:"tags",attrs:{prop_tags:t.prop_tags}})],1),s("q-separator",{staticClass:"q-mt-md"}),s("div",{staticClass:"q-mt-md"},[s("mavon-editor",{ref:"editor",on:{imgAdd:t.imgAdd},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("q-btn",{staticClass:"q-mt-md",attrs:{type:"submit",color:"primary",label:"提 交"}})],1)],1):t._e()},a=[],o=s("3855"),n={name:"OnePost",components:{Tags:o["a"]},data:function(){return{value:"",kind:"blog",head:"",can_reply:!0,is_open:!1,problem:"",post_id:0,prop_tags:[],loaded:!1}},methods:{get_html:function(){return this.$refs.editor.d_render},get_text:function(){return value},getForm:function(){var t=new FormData;return t.set("post_id",this.post_id),t.set("is_open",this.is_open),t.set("can_reply",this.can_reply),"blog"!=this.kind&&(this.problem=this.problem.trim(),""!=this.problem&&t.set("problem",this.problem)),t.set("content",this.value),t.set("html_content",this.get_html()),t.set("head",this.head),t.set("tags",JSON.stringify(this.$refs.tags.get_select_tags())),t},submit:function(){var t=this;0!=this.post_id&&this.$req.post("updatePost",this.getForm()).then((function(e){void 0==e.errno&&t.$notify("success","修改成功")}))},imgAdd:function(t,e){var s=this,i=new FormData;i.set("file",e),this.$req.post("addImg",i).then((function(e){s.$refs.editor.$img2Url(t,e.url)}))}},computed:{get_kind:function(){return"blog"==this.kind?"博客":"puzzle"==this.kind?"求助(讨论)贴":"solution"==this.kind?"题解":""}},mounted:function(){var t=this;this.post_id=this.$route.params.post_id,void 0==this.post_id&&this.$router.push({name:"personalHome"}),this.$req.get("onePost",{post_id:this.post_id}).then((function(e){void 0==e.errno?(e=e.post,t.kind=e.kind,t.head=e.head,t.value=e.content,t.can_reply=e.can_reply,t.is_open=e.is_open,t.problem=e.index,t.prop_tags=JSON.parse(e.tags),t.loaded=!0):t.$router.push({name:"personalHome"})}))}},r=n,l=s("4023"),d=s("eb85"),p=s("0378"),c=s("27f9"),m=s("9564"),u=s("9c40"),_=s("b2a3"),h=s.n(_),v=Object(l["a"])(r,i,a,!1,null,"29184f9c",null);e["default"]=v.exports;h()(v,"components",{QSeparator:d["a"],QForm:p["a"],QInput:c["a"],QToggle:m["a"],QBtn:u["a"]})}}]);